---
import AboutHeroImage from '../assets/blog-placeholder-about.jpg';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';

const pageTitle = 'About — Hacker Ethos';
const pageDescription = 'Who I am, what I build, and the hacker ethos behind my work.';
---

<html lang="en">
	<head>
		<BaseHead title={pageTitle} description={pageDescription} />
		<style is:global>
			body.term-page {
				background: #0a0a0a !important;
				background-image: none !important;
				color: rgba(0, 255, 65, 0.88);
				min-height: 100vh;
				scrollbar-width: thin;
				scrollbar-color: rgba(0, 255, 65, 0.3) transparent;
				/* header: amber gold */
				--chrome-bg: rgba(0, 0, 0, 0.85);
				--chrome-border: rgba(255, 184, 0, 0.2);
				--chrome-link: rgba(255, 200, 60, 0.88);
				--chrome-link-hover: rgba(255, 220, 100, 1);
				--chrome-active: rgba(255, 184, 0, 0.8);
				/* footer: dim cyan */
				--chrome-text-muted: rgba(0, 200, 220, 0.5);
			}
			body.term-page::-webkit-scrollbar { width: 6px; }
			body.term-page::-webkit-scrollbar-track { background: transparent; }
			body.term-page::-webkit-scrollbar-thumb {
				background: rgba(0, 255, 65, 0.24);
				border-radius: 3px;
			}
			/* fixed header + content offset (mirrors mesh-page in global.css) */
			body.term-page header {
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				z-index: 100;
				backdrop-filter: blur(3px);
				-webkit-backdrop-filter: blur(3px);
			}
			body.term-page .term-content {
				padding-top: calc(3em + 56px);
			}
			body.term-page .term-content,
			body.term-page footer {
				position: relative;
				z-index: 10;
			}
			/* footer: dim cyan */
			body.term-page footer {
				--chrome-bg: rgba(0, 0, 0, 0.85);
				--chrome-border: rgba(0, 200, 220, 0.18);
				border-top-color: rgba(0, 200, 220, 0.18) !important;
				color: rgba(0, 200, 220, 0.5);
			}
			body.term-page footer a {
				color: rgba(0, 200, 220, 0.55) !important;
			}
			body.term-page footer a:hover {
				color: rgba(0, 220, 240, 0.85) !important;
			}
			@media (max-width: 720px) {
				body.term-page .term-content {
					padding-top: calc(1em + 56px);
				}
			}
			/* ── terminal background ── */
			.term-bg {
				position: fixed;
				inset: 0;
				z-index: 0;
				overflow: hidden;
				pointer-events: none;
			}
			.term-bg-canvas {
				position: absolute;
				inset: 0;
				width: 100%;
				height: 100%;
			}
			.term-scanlines {
				position: absolute;
				inset: 0;
				background: repeating-linear-gradient(
					180deg,
					rgba(0, 0, 0, 0.06) 0px,
					rgba(0, 0, 0, 0.06) 1px,
					transparent 1px,
					transparent 3px
				);
				pointer-events: none;
			}
			.term-vignette {
				position: absolute;
				inset: 0;
				background: radial-gradient(
					ellipse at center,
					transparent 50%,
					rgba(0, 0, 0, 0.5) 80%,
					rgba(0, 0, 0, 0.85) 100%
				);
				pointer-events: none;
			}
			.term-flicker {
				position: absolute;
				inset: 0;
				background: transparent;
				animation: term-flicker-anim 0.08s infinite;
				opacity: 0.012;
				pointer-events: none;
			}
			@keyframes term-flicker-anim {
				0% { background: rgba(0, 255, 65, 0.015); }
				50% { background: transparent; }
				100% { background: rgba(0, 255, 65, 0.01); }
			}
			.term-glow {
				position: absolute;
				inset: 0;
				box-shadow: inset 0 0 120px rgba(0, 255, 65, 0.04);
				pointer-events: none;
			}
			/* ── content ── */
			.term-content {
				position: relative;
				z-index: 10;
			}
			.term-content .prose {
				position: relative;
				background:
					linear-gradient(180deg, rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0.85)),
					linear-gradient(180deg, rgba(0, 20, 5, 0.3), rgba(0, 10, 3, 0.4));
				border: 1px solid rgba(0, 255, 65, 0.08);
				border-radius: 8px;
				box-shadow:
					0 0 0 1px rgba(0, 255, 65, 0.04),
					0 16px 48px rgba(0, 0, 0, 0.5);
			}
			.about-shell {
				width: 720px;
				max-width: calc(100% - 2em);
				margin: 0 auto 2rem;
			}
			.hero-shell {
				width: min(1020px, 100%);
				margin: 0 auto;
				position: relative;
				box-sizing: border-box;
			}
			.hero-pane {
				position: relative;
				border-radius: 12px;
				overflow: hidden;
				border: 1px solid rgba(0, 255, 65, 0.2);
				box-shadow:
					0 0 0 1px rgba(0, 255, 65, 0.08),
					0 24px 48px rgba(0, 0, 0, 0.68),
					0 0 34px rgba(0, 0, 0, 0.64);
			}
			.hero-image {
				width: 100%;
				margin: 0;
				position: relative;
				box-sizing: border-box;
				border-radius: 0;
				overflow: hidden;
			}
			.hero-stack {
				position: relative;
				aspect-ratio: 1020 / 510;
				background: #050505;
			}
			.hero-canvas-wrap {
				position: absolute;
				inset: 0;
				z-index: 1;
				opacity: 0;
				transition: opacity 260ms ease;
			}
			.hero-canvas-wrap.ready { opacity: 1; }
			.hero-canvas {
				position: absolute;
				inset: 0;
				width: 100%;
				height: 100%;
				display: block;
			}
			.hero-frame {
				position: absolute;
				top: 0.65rem;
				left: 0.8rem;
				display: inline-flex;
				align-items: center;
				gap: 0.52rem;
				padding: 0.26rem 0.62rem;
				border: 1px solid rgba(0, 255, 65, 0.3);
				background: rgba(0, 0, 0, 0.8);
				border-radius: 6px;
				font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
				font-size: 0.65rem;
				letter-spacing: 0.14em;
				color: rgba(0, 255, 65, 0.9);
				text-transform: uppercase;
				pointer-events: none;
				z-index: 2;
				box-shadow:
					0 0 0 1px rgba(0, 255, 65, 0.08),
					0 0 14px rgba(0, 80, 30, 0.4);
			}
			.hero-frame-dot {
				width: 6px;
				height: 6px;
				border-radius: 50%;
				background: rgba(0, 255, 65, 0.98);
				box-shadow: 0 0 10px rgba(0, 255, 65, 0.72);
				animation: hero-frame-alert 1.1s ease-in-out infinite;
			}
			@keyframes hero-frame-alert {
				0%, 100% { opacity: 1; transform: scale(1); }
				50% { opacity: 0.35; transform: scale(0.82); }
			}
			.hero-threat-bar {
				width: 100%;
				margin: 0;
				display: flex;
				justify-content: space-between;
				gap: 0.6rem;
				padding: 0.24rem 0.5rem;
				box-sizing: border-box;
				border-top: 1px solid rgba(0, 255, 65, 0.15);
				background: linear-gradient(90deg, rgba(0, 8, 2, 0.7), rgba(0, 4, 1, 0.76));
				font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
				font-size: 0.58rem;
				letter-spacing: 0.12em;
				color: rgba(0, 255, 65, 0.72);
				text-transform: uppercase;
				pointer-events: none;
			}
			@media (max-width: 720px) {
				.hero-frame { font-size: 0.6rem; letter-spacing: 0.1em; }
				.hero-threat-bar { font-size: 0.52rem; letter-spacing: 0.08em; }
			}
			/* ── toast ── */
			.term-toast {
				position: fixed;
				right: 1rem;
				bottom: 1rem;
				z-index: 56;
				padding: 0.5rem 0.75rem;
				font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
				font-size: 0.7rem;
				letter-spacing: 0.08em;
				text-transform: uppercase;
				color: rgba(0, 255, 65, 0.98);
				background: rgba(0, 0, 0, 0.94);
				border: 1px solid rgba(0, 255, 65, 0.4);
				border-radius: 6px;
				box-shadow:
					0 0 0 1px rgba(0, 255, 65, 0.12),
					0 0 24px rgba(0, 255, 65, 0.18);
				opacity: 0;
				transform: translateY(8px);
				pointer-events: none;
				transition: opacity 0.18s ease, transform 0.18s ease;
			}
			.term-toast.visible {
				opacity: 1;
				transform: translateY(0);
			}
			/* ── progress bar ── */
			.term-progress {
				position: fixed;
				top: 0;
				left: 0;
				height: 3px;
				width: calc(var(--read-progress, 0) * 100%);
				background: linear-gradient(90deg, rgba(0, 255, 65, 0.7), rgba(0, 255, 65, 0.95));
				box-shadow: 0 0 12px rgba(0, 255, 65, 0.4);
				z-index: 100;
				pointer-events: none;
			}
			/* ── back to top ── */
			.term-back-to-top {
				position: fixed;
				right: 1.5rem;
				bottom: 3.5rem;
				width: 40px;
				height: 40px;
				border: 1px solid rgba(0, 255, 65, 0.3);
				border-radius: 8px;
				background: rgba(0, 0, 0, 0.88);
				color: rgba(0, 255, 65, 0.9);
				font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
				font-size: 1.1rem;
				cursor: pointer;
				z-index: 55;
				opacity: 0;
				transform: translateY(8px);
				transition: opacity 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
				pointer-events: none;
				box-shadow: 0 0 14px rgba(0, 255, 65, 0.1);
			}
			.term-back-to-top.visible {
				opacity: 1;
				transform: translateY(0);
				pointer-events: auto;
			}
			.term-back-to-top:hover {
				box-shadow: 0 0 20px rgba(0, 255, 65, 0.3);
				border-color: rgba(0, 255, 65, 0.5);
			}
			/* ── title ── */
			.about-title {
				margin-bottom: 1.4rem;
			}
			.term-meta {
				font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
				font-size: 0.78em;
				color: rgba(0, 255, 65, 0.6);
				margin-bottom: 0.62em;
				letter-spacing: 0.04em;
			}
			.term-title-bar {
				position: relative;
				height: 3px;
				margin: 0.75rem 0 0.1rem;
				border-radius: 999px;
				overflow: hidden;
				background: linear-gradient(
					90deg,
					rgba(0, 255, 65, 0.12),
					rgba(0, 255, 65, 0.22),
					rgba(0, 255, 65, 0.12)
				);
				box-shadow: 0 0 14px rgba(0, 255, 65, 0.15);
			}
			.term-title-bar::after {
				content: "";
				position: absolute;
				top: 0;
				bottom: 0;
				left: -35%;
				width: 35%;
				background: linear-gradient(
					90deg,
					rgba(0, 255, 65, 0),
					rgba(0, 255, 65, 0.8),
					rgba(0, 255, 65, 0)
				);
				animation: term-bar-sweep 3.8s linear infinite;
			}
			@keyframes term-bar-sweep {
				to { left: 100%; }
			}
			/* ── response panel ── */
			.term-response {
				border: 1px solid rgba(200, 210, 220, 0.12);
				background: rgba(0, 0, 0, 0.4);
				border-radius: 8px;
				padding: 0.75rem 0.9rem 0.45rem;
				box-shadow:
					inset 0 0 0 1px rgba(200, 210, 220, 0.05),
					0 8px 26px rgba(0, 0, 0, 0.32);
			}
			.term-response-header {
				display: flex;
				align-items: center;
				gap: 0.6em;
				margin-bottom: 0.8em;
			}
			.term-response-dot {
				width: 28px;
				height: 28px;
				border-radius: 50%;
				background: linear-gradient(145deg, rgba(220, 230, 240, 0.3), rgba(180, 195, 210, 0.2));
				border: 1px solid rgba(200, 210, 220, 0.25);
				box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.64), 0 0 14px rgba(200, 210, 220, 0.12);
			}
			.term-response-label {
				font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
				font-size: 0.8em;
				color: rgba(200, 210, 220, 0.7);
				font-weight: 600;
				letter-spacing: 0.08em;
				text-transform: uppercase;
			}
			/* ── prose body ── */
			.term-body p,
			.term-body h2,
			.term-body blockquote,
			.term-body .about-manifest {
				opacity: 0;
				transform: translateY(12px);
				transition: opacity 0.5s ease, transform 0.5s ease;
			}
			.term-body .term-visible {
				opacity: 1;
				transform: translateY(0);
			}
			.term-body a {
				color: rgba(0, 255, 65, 0.95);
				text-decoration-color: rgba(0, 255, 65, 0.3);
			}
			.term-body a:hover {
				text-decoration-color: rgba(0, 255, 65, 0.7);
			}
			/* ── cursor ── */
			.term-cursor {
				display: inline-block;
				width: 0.6em;
				height: 1.1em;
				background: rgba(0, 255, 65, 0.9);
				margin-left: 2px;
				vertical-align: text-bottom;
				animation: term-cursor-blink 1s step-end infinite;
			}
			@keyframes term-cursor-blink {
				0%, 50% { opacity: 1; }
				51%, 100% { opacity: 0; }
			}
			/* ── section titles ── */
			.about-section-title {
				font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
				font-size: 0.78rem;
				letter-spacing: 0.12em;
				text-transform: uppercase;
				color: rgba(0, 255, 65, 0.88);
				margin: 1.7rem 0 0.45rem;
			}
			/* ── manifest box ── */
			.about-manifest {
				margin: 1rem 0 1.4rem;
				padding: 0.8rem 0.95rem;
				border: 1px solid rgba(0, 255, 65, 0.16);
				border-radius: 8px;
				background: rgba(0, 0, 0, 0.4);
			}
			.about-manifest ul {
				margin: 0;
				padding-left: 1.1rem;
			}
			.about-manifest li {
				margin: 0.38rem 0;
			}
			.about-manifest li::marker {
				color: rgba(0, 255, 65, 0.5);
			}
			/* ── signature ── */
			.about-signature {
				margin-top: 1.2rem;
				font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
				font-size: 0.8rem;
				color: rgba(0, 255, 65, 0.7);
			}
			/* ── regenerate ── */
			.term-regenerate {
				display: block;
				margin: 2em auto 0;
				padding: 0.5em 1.2em;
				font-size: 0.85em;
				font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
				color: rgba(0, 255, 65, 0.9);
				background: rgba(0, 0, 0, 0.68);
				border: 1px solid rgba(0, 255, 65, 0.28);
				border-radius: 4px;
				cursor: pointer;
				letter-spacing: 0.06em;
				text-transform: uppercase;
				transition: all 0.2s ease;
			}
			.term-regenerate:hover:not(:disabled) {
				background: rgba(0, 255, 65, 0.08);
				box-shadow: 0 0 14px rgba(0, 255, 65, 0.2);
			}
			/* ── prose container ── */
			.prose {
				width: 720px;
				max-width: calc(100% - 2em);
				margin: auto;
				padding: 1em;
				color: rgba(0, 255, 65, 0.82);
			}
			.prose p {
				color: rgba(0, 255, 65, 0.78);
			}
			.prose hr {
				border-color: rgba(0, 255, 65, 0.15);
			}
			.hero-shell + .prose {
				margin-top: 1.1rem;
			}
			@media (max-width: 720px) {
				.hero-shell + .prose {
					margin-top: 0.85rem;
				}
			}
			.title {
				margin-bottom: 1em;
				padding: 1em 0;
				text-align: center;
				line-height: 1;
			}
			.title h1 {
				margin: 0 0 0.5em 0;
				color: rgba(0, 255, 65, 0.95);
			}
			/* ── mouse glow (green) ── */
			.term-mouse-glow {
				position: fixed;
				width: 300px;
				height: 300px;
				left: calc(var(--mouse-x, -9999px) - 150px);
				top: calc(var(--mouse-y, -9999px) - 150px);
				background: radial-gradient(circle, rgba(0, 255, 65, 0.06) 0%, transparent 70%);
				pointer-events: none;
				z-index: 1;
				border-radius: 50%;
			}
			/* ── load scan ── */
			.term-load-scan {
				position: fixed;
				left: 0;
				right: 0;
				height: 2px;
				background: linear-gradient(90deg, transparent, rgba(0, 255, 65, 0.6), rgba(0, 200, 50, 0.6), transparent);
				box-shadow: 0 0 12px rgba(0, 255, 65, 0.5);
				animation: term-scan 0.8s ease-out forwards;
				pointer-events: none;
				z-index: 20;
			}
			@keyframes term-scan {
				0% { top: 0; opacity: 1; }
				100% { top: 100vh; opacity: 0.2; }
			}
			/* ── flash on regenerate ── */
			.term-flash {
				animation: term-flash-anim 0.3s ease-out;
			}
			@keyframes term-flash-anim {
				0% { filter: brightness(2) saturate(0.5); }
				100% { filter: none; }
			}
		</style>
	</head>

	<body class="term-page">
		<div class="term-bg" aria-hidden="true">
			<canvas class="term-bg-canvas"></canvas>
			<div class="term-scanlines"></div>
			<div class="term-vignette"></div>
			<div class="term-flicker"></div>
			<div class="term-glow"></div>
		</div>
		<Header />
		<div class="term-progress" aria-hidden="true"></div>
		<button type="button" class="term-back-to-top" aria-label="Back to top" title="Back to top">↑</button>
		<div class="term-toast" aria-live="polite" aria-atomic="true"></div>
		<div class="term-mouse-glow" aria-hidden="true"></div>
		<main class="term-content">
			<div class="term-load-scan" aria-hidden="true"></div>
			<article class="about-shell">
				<div class="hero-shell">
					<div class="hero-pane">
						<div class="hero-image">
							<div class="hero-stack">
								<div class="hero-canvas-wrap" aria-hidden="true">
									<canvas class="hero-canvas" data-hero-src={AboutHeroImage.src}></canvas>
								</div>
							</div>
							<div class="hero-frame" aria-hidden="true">
								<span>hacker profile</span>
								<span class="hero-frame-dot"></span>
							</div>
						</div>
						<div class="hero-threat-bar" aria-hidden="true">
							<span>open source active</span>
							<span>build mode</span>
						</div>
					</div>
				</div>

				<div class="prose">
					<div class="title about-title">
						<div class="term-meta">$ profile booted | mode: builder</div>
						<h1>About — Hacker Ethos</h1>
						<hr />
						<div class="term-title-bar" aria-hidden="true"></div>
					</div>

					<div class="term-response">
						<div class="term-response-header">
							<div class="term-response-dot" aria-hidden="true"></div>
							<span class="term-response-label">Output</span>
						</div>
						<div class="term-body">
							<h2 class="about-section-title">01 / Who I Am</h2>
							<p>
								I am a product-minded engineer who treats software as craft: clear intent,
								fast iteration, and accountable execution.
							</p>

							<h2 class="about-section-title">02 / What I Build</h2>
							<p>
								I build web systems with Astro, TypeScript, and modern CSS, focused on
								content platforms, interface quality, and AI-era user experiences that remain
								performant and understandable.
							</p>

							<h2 class="about-section-title">03 / Hacker Ethos</h2>
							<div class="about-manifest">
								<ul>
									<li>Curiosity before certainty: test assumptions early.</li>
									<li>Craft before noise: ship clean interfaces and readable systems.</li>
									<li>Open collaboration: document decisions so teams can move together.</li>
									<li>Autonomy with accountability: own outcomes, not just output.</li>
								</ul>
							</div>

							<h2 class="about-section-title">04 / Now</h2>
							<p>
								Currently building a publish-ready Astro cyberpunk theme with configurable
								visual modes, stronger accessibility defaults, and reusable page variants.
							</p>

							<h2 class="about-section-title">05 / Contact</h2>
							<p>
								Open to collaboration on frontend architecture, theme systems, and product UX.
								Reach me via <a href="mailto:hello@example.com">email</a> or connect on
								<a href="https://github.com" target="_blank" rel="noopener noreferrer">GitHub</a>.
							</p>

							<blockquote class="about-signature">&gt; ship small, learn fast</blockquote>
							<span class="term-cursor" aria-hidden="true"></span>
						</div>
					</div>
					<button type="button" class="term-regenerate" aria-label="Regenerate">Regenerate</button>
				</div>
			</article>
		</main>
		<Footer />
		<script is:inline>
			(function() {
				function init() {
				// ── Terminal background canvas ──
				var bgCanvas = document.querySelector('.term-bg-canvas');
				if (bgCanvas) {
					var bgCtx = bgCanvas.getContext('2d');
					var lines = [];
					var logLines = [
						'[sys] kernel 6.1.0-rc4 loaded',
						'[net] eth0: link up 1000Mbps',
						'[ssh] listening on 0.0.0.0:22',
						'[fs]  /dev/sda1 mounted rw',
						'[proc] pid 1 init started',
						'[auth] pam_unix: session opened',
						'[sys] entropy pool initialized',
						'[net] firewall rules applied',
						'[cron] job scheduler active',
						'[sys] uptime: 847d 14h 22m',
						'[mem] 16384MB available',
						'[gpu] framebuffer /dev/fb0',
						'[net] dns resolver ready',
						'[sys] hostname: void-temple',
						'[proc] 127 processes running',
						'[fs]  swap: 8192MB configured',
						'[net] tor circuit established',
						'[auth] 2fa module loaded',
						'[sys] audit subsystem ready',
						'[net] vpn tunnel0 up',
						'$ cat /etc/motd',
						'>> welcome to the void',
						'[io]  block device ready',
						'[sys] watchdog timer set',
						'[net] ipv6 enabled',
						'[proc] cgroup v2 mounted',
						'[sys] seccomp filter loaded',
						'[fs]  tmpfs mounted /tmp',
						'[net] arp table populated',
						'$ whoami',
						'>> root',
						'[sys] load avg: 0.42 0.38 0.31',
					];
					var maxLines = 0;
					var fontSize = 13;
					var lineHeight = 18;
					var scrollOffset = 0;
					var lineTimer = 0;
					var lineIndex = 0;

					function sizeBackground() {
						var dpr = Math.min(window.devicePixelRatio || 1, 2);
						bgCanvas.width = window.innerWidth * dpr;
						bgCanvas.height = window.innerHeight * dpr;
						bgCanvas.style.width = window.innerWidth + 'px';
						bgCanvas.style.height = window.innerHeight + 'px';
						bgCtx.scale(dpr, dpr);
						maxLines = Math.ceil(window.innerHeight / lineHeight) + 4;
					}
					sizeBackground();

					// seed initial lines
					for (var k = 0; k < maxLines; k++) {
						lines.push(logLines[k % logLines.length]);
					}
					lineIndex = maxLines % logLines.length;

					function renderBg(t) {
						var w = window.innerWidth;
						var h = window.innerHeight;
						var dpr = Math.min(window.devicePixelRatio || 1, 2);

						bgCtx.setTransform(dpr, 0, 0, dpr, 0, 0);
						bgCtx.clearRect(0, 0, w, h);
						bgCtx.fillStyle = '#0a0a0a';
						bgCtx.fillRect(0, 0, w, h);

						// draw log lines
						bgCtx.font = fontSize + 'px ui-monospace, SFMono-Regular, Menlo, monospace';
						var baseY = 20 - scrollOffset;
						for (var i = 0; i < lines.length; i++) {
							var y = baseY + i * lineHeight;
							if (y < -lineHeight || y > h + lineHeight) continue;
							// fade near edges
							var alpha = 0.1;
							if (y < 60) alpha *= y / 60;
							if (y > h - 60) alpha *= (h - y) / 60;
							if (alpha <= 0) continue;
							bgCtx.fillStyle = 'rgba(0, 255, 65, ' + Math.max(0, alpha).toFixed(3) + ')';
							bgCtx.fillText(lines[i], 20, y);
						}

						// scroll
						scrollOffset += 0.3;
						if (scrollOffset >= lineHeight) {
							scrollOffset -= lineHeight;
							lines.shift();
							lines.push(logLines[lineIndex % logLines.length]);
							lineIndex++;
						}

						requestAnimationFrame(renderBg);
					}
					requestAnimationFrame(renderBg);

					window.addEventListener('resize', function() {
						sizeBackground();
					}, { passive: true });
				}

				// ── Progress bar + toasts + back-to-top ──
				var progress = document.querySelector('.term-progress');
				var toast = document.querySelector('.term-toast');
				var stageSeen = { p30: false, p60: false, p90: false };
				var toastTimer = 0;
				var hasScrolled = false;
				function showToast(msg) {
					if (!toast) return;
					toast.textContent = '> ' + msg;
					toast.classList.add('visible');
					clearTimeout(toastTimer);
					toastTimer = setTimeout(function() {
						toast.classList.remove('visible');
					}, 900);
				}
				if (progress) {
					function onScroll() {
						var scrollTop = window.scrollY || document.documentElement.scrollTop;
						var scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
						var p = scrollHeight > 0 ? Math.min(1, scrollTop / scrollHeight) : 1;
						progress.style.setProperty('--read-progress', String(p));
						var btn = document.querySelector('.term-back-to-top');
						if (btn) btn.classList.toggle('visible', scrollTop > 400);
						if (!hasScrolled && scrollTop > 6) hasScrolled = true;
						if (!hasScrolled) return;
						if (!stageSeen.p30 && p >= 0.3) {
							stageSeen.p30 = true;
							showToast('context parsed');
						}
						if (!stageSeen.p60 && p >= 0.6) {
							stageSeen.p60 = true;
							showToast('inference stable');
						}
						if (!stageSeen.p90 && p >= 0.9) {
							stageSeen.p90 = true;
							showToast('output finalized');
						}
					}
					onScroll();
					window.addEventListener('scroll', onScroll, { passive: true });
				}
				var backTop = document.querySelector('.term-back-to-top');
				if (backTop) {
					backTop.addEventListener('click', function() {
						window.scrollTo({ top: 0, behavior: 'smooth' });
					});
				}

				// ── Hero canvas AI effects ──
				function initHeroCanvas() {
					var shell = document.querySelector('.hero-shell');
					if (!shell) return;
					var canvas = shell.querySelector('.hero-canvas');
					var wrap = shell.querySelector('.hero-canvas-wrap');
					if (!canvas || !wrap) return;
					var src = canvas.getAttribute('data-hero-src');
					if (!src) return;

					var heroStart = 0;
					var heroRaf = 0;
					var baseCanvas = document.createElement('canvas');
					var baseCtx = baseCanvas.getContext('2d');
					var edgeCanvas = document.createElement('canvas');
					var edgeCtx = edgeCanvas.getContext('2d');
					var edgeReady = false;

					var EDGE_PHASE = 1.8;
					var REVEAL_PHASE = 2.5;
					var INTRO_END = EDGE_PHASE + REVEAL_PHASE;

					function sizeCanvas() {
						var rect = shell.querySelector('.hero-stack').getBoundingClientRect();
						var dpr = Math.min(window.devicePixelRatio || 1, 2);
						canvas.width = Math.max(2, Math.round(rect.width * dpr));
						canvas.height = Math.max(2, Math.round(rect.height * dpr));
						canvas.style.width = rect.width + 'px';
						canvas.style.height = rect.height + 'px';
					}

					function drawBase(ctx, img, w, h) {
						var iw = img.width, ih = img.height;
						var scale = Math.max(w / iw, h / ih);
						var sw = w / scale, sh = h / scale;
						var sx = (iw - sw) / 2, sy = (ih - sh) / 2;
						ctx.drawImage(img, sx, sy, sw, sh, 0, 0, w, h);
					}

					function buildEdge(img) {
						var w = canvas.width, h = canvas.height;
						edgeCanvas.width = w;
						edgeCanvas.height = h;
						baseCanvas.width = w;
						baseCanvas.height = h;
						drawBase(baseCtx, img, w, h);
						drawBase(edgeCtx, img, w, h);
						var src = edgeCtx.getImageData(0, 0, w, h);
						var d = src.data;
						var out = edgeCtx.createImageData(w, h);
						var od = out.data;
						for (var y = 1; y < h - 1; y++) {
							for (var x = 1; x < w - 1; x++) {
								var idx = function(px, py) { return ((py * w) + px) * 4; };
								var i = idx(x, y);
								function luma(px, py) {
									var j = idx(px, py);
									return d[j] * 0.299 + d[j+1] * 0.587 + d[j+2] * 0.114;
								}
								var gx = -luma(x-1,y-1) - 2*luma(x-1,y) - luma(x-1,y+1)
								         + luma(x+1,y-1) + 2*luma(x+1,y) + luma(x+1,y+1);
								var gy = -luma(x-1,y-1) - 2*luma(x,y-1) - luma(x+1,y-1)
								         + luma(x-1,y+1) + 2*luma(x,y+1) + luma(x+1,y+1);
								var mag = Math.min(255, Math.sqrt(gx * gx + gy * gy));
								// green-tinted edges instead of cyan
								od[i]   = 0;
								od[i+1] = Math.min(255, mag * 1.0);
								od[i+2] = Math.min(255, mag * 0.3);
								od[i+3] = mag > 20 ? Math.min(255, mag * 1.5) : 0;
							}
						}
						edgeCtx.putImageData(out, 0, 0);
						edgeReady = true;
					}

					function heroRender(t) {
						if (!heroStart) heroStart = t;
						var elapsed = (t - heroStart) * 0.001;
						var ctx = canvas.getContext('2d');
						if (!ctx || !canvas.img) { heroRaf = requestAnimationFrame(heroRender); return; }
						var w = canvas.width, h = canvas.height;

						ctx.clearRect(0, 0, w, h);

						if (elapsed < EDGE_PHASE && edgeReady) {
							var edgeFade = Math.min(1, elapsed / 0.5);
							ctx.fillStyle = '#050505';
							ctx.fillRect(0, 0, w, h);
							ctx.globalAlpha = edgeFade;
							ctx.drawImage(edgeCanvas, 0, 0);
							ctx.globalAlpha = 1;
							var scanY = (elapsed / EDGE_PHASE) * h;
							ctx.fillStyle = 'rgba(0, 255, 65, 0.3)';
							ctx.fillRect(0, scanY - 1, w, 2);
							var scanGlow = ctx.createLinearGradient(0, scanY - 30, 0, scanY + 30);
							scanGlow.addColorStop(0, 'rgba(0, 255, 65, 0)');
							scanGlow.addColorStop(0.5, 'rgba(0, 255, 65, 0.15)');
							scanGlow.addColorStop(1, 'rgba(0, 255, 65, 0)');
							ctx.fillStyle = scanGlow;
							ctx.fillRect(0, scanY - 30, w, 60);

						} else if (elapsed < INTRO_END) {
							var revealT = (elapsed - EDGE_PHASE) / REVEAL_PHASE;
							var maxBlock = 32;
							var blockSize = Math.max(1, Math.round(maxBlock * (1 - revealT * revealT)));
							if (blockSize > 1) {
								var tmpCanvas = document.createElement('canvas');
								var smallW = Math.max(1, Math.ceil(w / blockSize));
								var smallH = Math.max(1, Math.ceil(h / blockSize));
								tmpCanvas.width = smallW;
								tmpCanvas.height = smallH;
								var tmpCtx = tmpCanvas.getContext('2d');
								tmpCtx.drawImage(baseCanvas, 0, 0, smallW, smallH);
								ctx.imageSmoothingEnabled = false;
								ctx.drawImage(tmpCanvas, 0, 0, smallW, smallH, 0, 0, w, h);
								ctx.imageSmoothingEnabled = true;
							} else {
								ctx.drawImage(baseCanvas, 0, 0);
							}
							var tintAlpha = 0.18 * (1 - revealT);
							ctx.globalCompositeOperation = 'screen';
							ctx.fillStyle = 'rgba(0, 200, 50, ' + tintAlpha + ')';
							ctx.fillRect(0, 0, w, h);
							ctx.globalCompositeOperation = 'source-over';

						} else {
							ctx.drawImage(baseCanvas, 0, 0);
							ctx.fillStyle = 'rgba(0, 0, 0, 0.03)';
							for (var i = 0; i < h; i += 3) {
								ctx.fillRect(0, i, w, 1);
							}
							var scanPos = ((elapsed * 40) % (h + 60)) - 30;
							var barGrad = ctx.createLinearGradient(0, scanPos - 30, 0, scanPos + 30);
							barGrad.addColorStop(0, 'rgba(0, 255, 65, 0)');
							barGrad.addColorStop(0.5, 'rgba(0, 255, 65, 0.06)');
							barGrad.addColorStop(1, 'rgba(0, 255, 65, 0)');
							ctx.fillStyle = barGrad;
							ctx.fillRect(0, scanPos - 30, w, 60);
							if (Math.random() < 0.08) {
								var glitchY = Math.random() * h;
								var glitchH = 2 + Math.random() * 12;
								var shiftX = (Math.random() - 0.5) * 12;
								var strip = ctx.getImageData(0, Math.floor(glitchY), w, Math.ceil(glitchH));
								var sd = strip.data;
								var shiftPx = Math.round(shiftX) * 4;
								if (shiftPx > 0) {
									for (var j = sd.length - 4; j >= shiftPx; j -= 4) {
										sd[j] = sd[j - shiftPx];
									}
								} else if (shiftPx < 0) {
									for (var j = 0; j < sd.length + shiftPx; j += 4) {
										sd[j] = sd[j - shiftPx];
									}
								}
								ctx.putImageData(strip, 0, Math.floor(glitchY));
							}
							if (Math.random() < 0.03) {
								var burstY = Math.random() * h * 0.8;
								var burstH = 4 + Math.random() * 20;
								var noise = ctx.createImageData(w, Math.ceil(burstH));
								var nd = noise.data;
								for (var j = 0; j < nd.length; j += 4) {
									var v = Math.random() * 255;
									nd[j] = 0;
									nd[j+1] = v * 0.8;
									nd[j+2] = v * 0.2;
									nd[j+3] = 30 + Math.random() * 40;
								}
								ctx.putImageData(noise, 0, Math.floor(burstY));
							}
						}

						heroRaf = requestAnimationFrame(heroRender);
					}

					var img = new Image();
					img.onload = function() {
						canvas.img = img;
						sizeCanvas();
						buildEdge(img);
						wrap.classList.add('ready');
						heroRaf = requestAnimationFrame(heroRender);
					};
					img.src = new URL(src, window.location.href).href;

					window.addEventListener('resize', function() {
						if (canvas.img) {
							sizeCanvas();
							buildEdge(canvas.img);
						}
					}, { passive: true });
					window.addEventListener('beforeunload', function() { cancelAnimationFrame(heroRaf); }, { once: true });
				}
				initHeroCanvas();

				// ── Mouse glow ──
				var glow = document.querySelector('.term-mouse-glow');
				if (glow) {
					var glowRaf;
					var mx = 0, my = 0;
					document.addEventListener('mousemove', function(e) {
						mx = e.clientX;
						my = e.clientY;
						if (!glowRaf) glowRaf = requestAnimationFrame(function() {
							glow.style.setProperty('--mouse-x', mx + 'px');
							glow.style.setProperty('--mouse-y', my + 'px');
							glowRaf = 0;
						});
					});
				}

				// ── Paragraph scroll reveal ──
				var paras = document.querySelectorAll('.term-body p, .term-body h2, .term-body blockquote, .about-manifest');
				if (window.IntersectionObserver) {
					var io = new IntersectionObserver(function(entries) {
						entries.forEach(function(e) {
							if (e.isIntersecting) {
								e.target.classList.add('term-visible');
								io.unobserve(e.target);
							}
						});
					}, { rootMargin: '0px 0px -60px 0px', threshold: 0.1 });
					paras.forEach(function(p) { io.observe(p); });
				} else {
					paras.forEach(function(p) { p.classList.add('term-visible'); });
				}

				// ── Typewriter section titles ──
				var titles = document.querySelectorAll('.about-section-title');
				if (window.IntersectionObserver && titles.length) {
					titles.forEach(function(el) {
						var fullText = el.textContent || '';
						el.setAttribute('data-full-text', fullText);
						el.textContent = '';
						el.style.minHeight = '1.2em';
					});
					var tio = new IntersectionObserver(function(entries) {
						entries.forEach(function(e) {
							if (e.isIntersecting) {
								tio.unobserve(e.target);
								var text = e.target.getAttribute('data-full-text') || '';
								var i = 0;
								e.target.textContent = '';
								function type() {
									if (i <= text.length) {
										e.target.textContent = text.slice(0, i);
										i++;
										setTimeout(type, 32);
									}
								}
								type();
							}
						});
					}, { rootMargin: '0px 0px -40px 0px', threshold: 0.1 });
					titles.forEach(function(el) { tio.observe(el); });
				}

				// ── Regenerate button ──
				var regen = document.querySelector('.term-regenerate');
				var article = document.querySelector('.about-shell');
				var scan = document.querySelector('.term-load-scan');
				if (regen && article) {
					regen.addEventListener('click', function() {
						regen.disabled = true;
						article.classList.add('term-flash');
						if (scan) {
							scan.style.animation = 'none';
							scan.offsetHeight;
							scan.style.animation = 'term-scan 0.8s ease-out forwards';
							scan.style.top = '0';
							scan.style.opacity = '1';
						}
						setTimeout(function() {
							article.classList.remove('term-flash');
							regen.disabled = false;
						}, 1200);
					});
				}
			}

			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', init);
			} else {
				init();
			}
		})();
		</script>
	</body>
</html>
